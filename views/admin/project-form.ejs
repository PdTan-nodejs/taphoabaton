<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= project ? 'Chỉnh sửa dự án' : 'Tạo dự án mới' %> - Admin</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/admin.css">
    <script src="https://cdn.ckeditor.com/4.16.2/standard/ckeditor.js"></script>
</head>
<body>
    <%- include('../partials/admin-header') %>
    
    <div class="admin-container">
        <div class="admin-sidebar">
            <ul class="admin-menu">
                <li><a href="/admin/dashboard">Dashboard</a></li>
                <li><a href="/admin/posts">Quản lý bài viết</a></li>
                <li><a href="/admin/pages">Quản lý trang</a></li>
                <li><a href="/admin/projects">Quản lý dự án</a></li>
                <li><a href="/">Về trang chủ</a></li>
                <li><a href="/admin/logout">Đăng xuất</a></li>
            </ul>
        </div>
        
        <div class="admin-content">
            <h1><%= project ? 'Chỉnh sửa dự án' : 'Tạo dự án mới' %></h1>
            
            <form action="<%= project ? '/admin/projects/' + project.id : '/admin/projects' %>" method="POST" enctype="multipart/form-data" class="post-form">
                <div class="form-group">
                    <label for="title">Tiêu đề *</label>
                    <input type="text" id="title" name="title" value="<%= project ? project.title : '' %>" required>
                </div>
                
                <div class="form-group">
                    <label for="description">Mô tả ngắn</label>
                    <textarea id="description" name="description" rows="3"><%= project ? project.description || '' : '' %></textarea>
                </div>
                
                <div class="form-group">
                    <label for="content">Nội dung</label>
                    <textarea id="content" name="content"><%= project ? project.content || '' : '' %></textarea>
                </div>
                
                <div class="form-group">
                    <label for="image">Hình ảnh</label>
                    <% if (project && project.image) { %>
                    <div class="current-image">
                        <img src="/uploads/<%= project.image %>" alt="Current image">
                        <p>Ảnh hiện tại</p>
                    </div>
                    <% } %>
                    <input type="file" id="image" name="image" accept="image/*">
                    <small>Chỉ chấp nhận file ảnh (jpg, png, gif, webp), tối đa 5MB</small>
                </div>
                
                <div class="form-group">
                    <label for="link">Link dự án</label>
                    <input type="url" id="link" name="link" value="<%= project ? project.link || '' : '' %>">
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="featured" <%= project && project.featured ? 'checked' : '' %>>
                        Nổi bật
                    </label>
                </div>
                
                <div class="form-group">
                    <label for="status">Trạng thái</label>
                    <select id="status" name="status">
                        <option value="draft" <%= project && project.status === 'draft' ? 'selected' : '' %>>Bản nháp</option>
                        <option value="published" <%= project && project.status === 'published' ? 'selected' : '' %>>Đã xuất bản</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn-primary"><%= project ? 'Cập nhật' : 'Tạo mới' %></button>
                    <a href="/admin/projects" class="btn-secondary">Hủy</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        CKEDITOR.replace('content', {
            height: 400
        });
    </script>
</body>
</html>
